<!DOCTYPE html>

<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Class Scheduling System</title>
  <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
  <script src="function.js"></script>
  <style>
    table {
      width: 100%;
      border-collapse: collapse;
      margin: 20px 0;
    }
    th, td {
      border: 1px solid #000;
      padding: 8px;
      text-align: center;
    }
    th {
      background-color: #f3f3f3;
    }
    h1 {
      text-align: center;
      margin-bottom: 20px;
    }
  </style>
</head>
<body class="bg-gray-100 min-h-screen flex items-center justify-center">
  <div class="w-full max-w-6xl p-6 bg-white shadow-md rounded-lg">
    <h1 class="text-4xl font-bold text-center mb-6">Class Scheduling System</h1>

    <form id="combined-form">
      <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-8">
        
        <div class="bg-gray-50 p-4 rounded shadow">
          <h2 class="font-semibold text-lg mb-2">Add Faculty</h2>
          <div class="space-y-2">
            <input type="text" id="faculty-name" placeholder="Faculty Name" class="w-full p-2 border rounded" required />
            <input type="text" id="faculty-type" placeholder="AM / PM" class="w-full p-2 border rounded" />
          </div>
        </div>

        <div class="bg-gray-50 p-4 rounded shadow">
          <h2 class="font-semibold text-lg mb-2">Add Room</h2>
          <div class="space-y-2">
            <input type="text" id="room-name-unique" placeholder="Room Name" class="w-full p-2 border rounded" required />
            <input type="text" id="room-type-unique" placeholder="Room Type (e.g. Lab)" class="w-full p-2 border rounded" />
          </div>
        </div>

        <div class="bg-gray-50 p-4 rounded shadow">
          <h2 class="font-semibold text-lg mb-2">Add Section</h2>
          <div class="space-y-2">
            <input type="text" id="program" placeholder="Program" class="w-full p-2 border rounded" required />
            <input type="text" id="section" placeholder="Section (e.g. A)" class="w-full p-2 border rounded" />
          </div>
        </div>

        <div class="bg-gray-50 p-4 rounded shadow">
          <h2 class="font-semibold text-lg mb-2">Add Subject</h2>
          <div class="space-y-2">
            <input type="text" id="subject-name" placeholder="Subject Name" class="w-full p-2 border rounded" required />
            <input type="text" id="subject-room-type" placeholder="Required Room Type" class="w-full p-2 border rounded" />
          </div>
        </div>
      </div>

      <div class="flex justify-center mb-6">
        <button type="submit" class="bg-blue-600 text-white px-6 py-2 rounded shadow">ADD</button>
      </div>
    </form>

    <div class="flex justify-center gap-4 mb-6">
      <button onclick="generateSchedule()" class="bg-green-600 text-white px-6 py-2 rounded shadow">Generate Schedule</button>
    </div>

    <div class="flex justify-center gap-4 mb-6">
        <button onclick="printSchedule()" class="bg-yellow-600 text-white px-6 py-2 rounded shadow">Print Schedule</button>
      </div>
      

    <div id="schedule-output" class="text-center"></div>
  </div>


      <script>
        const faculties = [];
        const rooms = [];
        const subjects = [];
        const section = [];
      
        document.getElementById('combined-form').addEventListener('submit', function (e) {
          e.preventDefault();
      
          const facultyName = document.getElementById('faculty-name').value.trim();
          const facultyType = document.getElementById('faculty-type').value.trim();
          const roomName = document.getElementById('room-name-unique').value.trim();
          const roomType = document.getElementById('room-type-unique').value.trim();
          const subjectName = document.getElementById('subject-name').value.trim();
          const subjectRoomType = document.getElementById('subject-room-type').value.trim();
          const programName = document.getElementById('program').value.trim();
          const sectionName = document.getElementById('section').value.trim();
      
          faculties.push({ name: facultyName, type: facultyType });
          rooms.push({ name: roomName, type: roomType });
          subjects.push({ name: subjectName, roomType: subjectRoomType });
          section.push({ name: programName, roomType: sectionName });
      
          this.reset();
          alert('All data added successfully!');
        });
      
        function generateSchedule() {
          const schedule = [];
          let facultyIndex = 0;
          let roomIndex = 0;
          let sectionIndex = 0;
      
          subjects.forEach((subject) => {
            const availableRoom = rooms.find(room => room.type.toLowerCase() === subject.roomType.toLowerCase());
            const faculty = faculties[facultyIndex % faculties.length];
            const room = availableRoom || rooms[roomIndex % rooms.length];
            const sect = section[sectionIndex % section.length];
      
            schedule.push({
              subject: subject.name,
              faculty: faculty.name,
              room: room.name,
              roomType: room.type,
              program: sect.name,
              section: sect.roomType,
            });
      
            facultyIndex++;
            roomIndex++;
            sectionIndex++;
          });
      
          displaySchedule(schedule);
        }
      
        function displaySchedule(schedule) {
          const output = document.getElementById('schedule-output');
          if (schedule.length === 0) {
            output.innerHTML = '<p class="text-red-500 font-semibold">No schedule to display. Please add data first.</p>';
            return;
          }
      
          output.innerHTML = `
            <h2 class="text-2xl font-bold mb-4 text-center">Generated Schedule</h2>
            <div class="overflow-x-auto">
              <table class="min-w-full table-auto border border-gray-300 rounded shadow bg-white">
                <thead class="bg-gray-200">
                  <tr>
                    <th class="border px-4 py-2">Subject</th>
                    <th class="border px-4 py-2">Faculty</th>
                    <th class="border px-4 py-2">Room</th>
                    <th class="border px-4 py-2">Room Type</th>
                    <th class="border px-4 py-2">Program</th>
                    <th class="border px-4 py-2">Section</th>
                    <th class="border px-4 py-2">Actions</th>
                  </tr>
                </thead>
                <tbody>
                  ${schedule.map((entry, index) => `
                    <tr>
                      <td class="border px-4 py-2">${entry.subject}</td>
                      <td class="border px-4 py-2">${entry.faculty}</td>
                      <td class="border px-4 py-2">${entry.room}</td>
                      <td class="border px-4 py-2">${entry.roomType}</td>
                      <td class="border px-4 py-2">${entry.program}</td>
                      <td class="border px-4 py-2">${entry.section}</td>
                      <td class="border px-4 py-2">
                        <button class="bg-blue-500 text-white px-4 py-2 rounded" onclick="updateSubject(${index})">Update</button>
                        <button class="bg-red-500 text-white px-4 py-2 rounded" onclick="deleteSubject(${index})">Delete</button>
                      </td>
                    </tr>
                  `).join('')}
                </tbody>
              </table>
            </div>
          `;
        }

        function updateSubject(index) {
          const newSubject = prompt("Enter new subject name:", subjects[index].name);
          if (newSubject !== null && newSubject.trim() !== "") {
            subjects[index].name = newSubject.trim();
            generateSchedule();
          }
        }

        function deleteSubject(index) {
          if (confirm("Are you sure you want to delete this subject?")) {
            subjects.splice(index, 1);
            generateSchedule();
          }
        }
      
        function printSchedule() {
          const scheduleOutput = document.getElementById('schedule-output').innerHTML;
          if (!scheduleOutput) {
            alert("No schedule to print.");
            return;
          }

          let cleanedOutput = scheduleOutput.replace(
            /<th class="border px-4 py-2">Actions<\/th>/,
            ''
          );

          cleanedOutput = cleanedOutput.replace(
            /<td class="border px-4 py-2">\s*<button[^<]*<\/button>\s*<button[^<]*<\/button>\s*<\/td>/g,
            ''
          );

          const newWindow = window.open('', '', 'width=800, height=600');
          newWindow.document.write(`
            <html>
            <head>
              <title>Print Schedule</title>
              <style>
                body {
                  font-family: sans-serif;
                  padding: 20px;
                }
                h1 {
                  text-align: center;
                  margin-bottom: 20px;
                }
                table {
                  width: 100%;
                  border-collapse: collapse;
                  margin: 0 auto;
                }
                th, td {
                  border: 1px solid #000;
                  padding: 8px;
                  text-align: center;
                }
                th {
                  background-color: #f3f4f6;
                }
              </style>
            </head>
            <body>
              <h1>Generated Class Schedule</h1>
              ${cleanedOutput}
            </body>
            </html>
          `);
          newWindow.document.close();
          newWindow.print();
        }
      </script>
</body>
</html>